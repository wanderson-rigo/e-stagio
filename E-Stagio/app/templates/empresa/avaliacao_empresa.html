{% extends "base_empresa.html" %}
{% block content %}
<div class="container mt-4">
    <a href="{{ url_for('index_empresa') }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Voltar</a>
    <h2>Avaliação da Empresa</h2>
    <form method="POST">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.empresa_nota_interesse.label(class="form-label") }}
            {{ form.empresa_nota_interesse(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_interesse.errors else "")) }}
            {% for error in form.empresa_nota_interesse.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_iniciativa.label(class="form-label") }}
            {{ form.empresa_nota_iniciativa(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_iniciativa.errors else "")) }}
            {% for error in form.empresa_nota_iniciativa.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_cooperacao.label(class="form-label") }}
            {{ form.empresa_nota_cooperacao(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_cooperacao.errors else "")) }}
            {% for error in form.empresa_nota_cooperacao.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_assiduidade.label(class="form-label") }}
            {{ form.empresa_nota_assiduidade(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_assiduidade.errors else "")) }}
            {% for error in form.empresa_nota_assiduidade.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_pontualidade.label(class="form-label") }}
            {{ form.empresa_nota_pontualidade(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_pontualidade.errors else "")) }}
            {% for error in form.empresa_nota_pontualidade.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_disciplina.label(class="form-label") }}
            {{ form.empresa_nota_disciplina(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_disciplina.errors else "")) }}
            {% for error in form.empresa_nota_disciplina.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_sociabilidade.label(class="form-label") }}
            {{ form.empresa_nota_sociabilidade(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_sociabilidade.errors else "")) }}
            {% for error in form.empresa_nota_sociabilidade.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_adaptabilidade.label(class="form-label") }}
            {{ form.empresa_nota_adaptabilidade(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_adaptabilidade.errors else "")) }}
            {% for error in form.empresa_nota_adaptabilidade.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_responsabilidade.label(class="form-label") }}
            {{ form.empresa_nota_responsabilidade(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_responsabilidade.errors else "")) }}
            {% for error in form.empresa_nota_responsabilidade.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_nota_etica.label(class="form-label") }}
            {{ form.empresa_nota_etica(type="number", class="form-control" + (" is-invalid" if form.empresa_nota_etica.errors else "")) }}
            {% for error in form.empresa_nota_etica.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.empresa_atividades.label(class="form-label") }}
            {{ form.empresa_atividades(class="form-control" + (" is-invalid" if form.empresa_atividades.errors else "")) }}
            {% for error in form.empresa_atividades.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            {{ form.emprsa_comentarios.label(class="form-label") }}
            {{ form.emprsa_comentarios(class="form-control" + (" is-invalid" if form.emprsa_comentarios.errors else "")) }}
            {% for error in form.emprsa_comentarios.errors %}
            <div class="invalid-feedback">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="form-group">
            <label for="media_notas" class="form-label">Média das Notas</label>
            <input type="text" id="media_notas" class="form-control" readonly>
        </div>
        <button type="submit" class="btn btn-primary">Salvar Avaliação</button>
    </form>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const notaFields = document.querySelectorAll('input[type="number"]');
        const mediaField = document.getElementById('media_notas');

        function calculateMedia() {
            let total = 0;
            let count = 0;

            notaFields.forEach(function (field) {
                const value = parseFloat(field.value);
                if (!isNaN(value)) {
                    total += value;
                    count += 1;
                }
            });

            const media = (count > 0) ? (total / count).toFixed(2) : 0;
            mediaField.value = media;
        }

        notaFields.forEach(function (field) {
            field.addEventListener('input', calculateMedia);
        });

        calculateMedia();
    });
</script>
{% endblock %}
